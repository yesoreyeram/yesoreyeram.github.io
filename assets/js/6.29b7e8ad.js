(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{204:function(t,s,a){t.exports=a.p+"assets/img/aks-summary-in-grafana.60a41f36.png"},215:function(t,s,a){"use strict";a.r(s);var e=a(0),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"azure-kubernetes-clusters-summary-in-grafana"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#azure-kubernetes-clusters-summary-in-grafana"}},[t._v("#")]),t._v(" Azure Kubernetes clusters summary in Grafana")]),t._v(" "),e("p",[t._v("When managing multiple "),e("strong",[t._v("kubernetes")]),t._v(" clusters / "),e("strong",[t._v("AKS")]),t._v(" in azure, it is good to know the state / size of all kubernetes clusters in single place like grafana dashboard. In this post, I will be explaining the easiest way to get the state of all the clusters across all of your "),e("strong",[t._v("Azure")]),t._v(" subscriptions in Grafana.")]),t._v(" "),e("p",[t._v("We are going to use "),e("a",{attrs:{href:"https://azure.microsoft.com/en-us/features/resource-graph/",target:"_blank",rel:"noopener noreferrer"}},[e("strong",[t._v("Azure Resource Graph")]),e("OutboundLink")],1),t._v(" to get the results. To get the azure resource graph results in grafana, I am using "),e("a",{attrs:{href:"https://github.com/yesoreyeram/grafana-azure-datasource",target:"_blank",rel:"noopener noreferrer"}},[t._v("Grafana Azure Datasource"),e("OutboundLink")],1),t._v(" plugin. You can also use the queries wihtout grafana in Azure dashboard.")]),t._v(" "),e("p",[t._v("Below is the screenshot of the Grafana dashboard.")]),t._v(" "),e("p",[e("img",{attrs:{src:a(204),alt:"Image from alias"}})]),t._v(" "),e("h3",{attrs:{id:"pre-requisites"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pre-requisites"}},[t._v("#")]),t._v(" Pre-Requisites")]),t._v(" "),e("ul",[e("li",[t._v("Reader access to the necessary subscription ( in case of using with Grafana, need a SPN with Reader access to the subscription )")]),t._v(" "),e("li",[e("a",{attrs:{href:"https://grafana.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Grafana"),e("OutboundLink")],1),t._v(" 5.2.x or newer")]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/yesoreyeram/grafana-azure-datasource",target:"_blank",rel:"noopener noreferrer"}},[t._v("Grafana Azure Datasource"),e("OutboundLink")],1),t._v(" plugin")])]),t._v(" "),e("h3",{attrs:{id:"setup"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setup"}},[t._v("#")]),t._v(" Setup")]),t._v(" "),e("p",[t._v("Once installed the Grafana and Grafana azure data source plugin, You need to configure the SPN as the datasource for Grafana. Then like any other grafana dashboard, you can query the Azure Resoruce Graph in grafana.")]),t._v(" "),e("h2",{attrs:{id:"azure-resource-graph-queries"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#azure-resource-graph-queries"}},[t._v("#")]),t._v(" Azure Resource Graph queries")]),t._v(" "),e("p",[t._v("Below is the list of azure resource graph queries I am using in the dashboard.")]),t._v(" "),e("h4",{attrs:{id:"total-number-of-aks-clusters"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#total-number-of-aks-clusters"}},[t._v("#")]),t._v(" Total Number of AKS Clusters")]),t._v(" "),e("div",{staticClass:"language-py extra-class"},[e("pre",{pre:!0,attrs:{class:"language-py"}},[e("code",[t._v("resources\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" where "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),t._v(" contains "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"microsoft.containerservice/managedclusters"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" count\n")])])]),e("h4",{attrs:{id:"total-number-of-aks-clusters-by-kubernetes-version"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#total-number-of-aks-clusters-by-kubernetes-version"}},[t._v("#")]),t._v(" Total number of AKS Clusters by Kubernetes version")]),t._v(" "),e("div",{staticClass:"language-py extra-class"},[e("pre",{pre:!0,attrs:{class:"language-py"}},[e("code",[t._v("resources \n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" where "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),t._v(" contains "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"microsoft.containerservice/managedclusters"')]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" extend cluster_version "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tostring"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("properties"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("kubernetesVersion"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" summarize count "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" count"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" by cluster_version\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" order by cluster_version asc\n")])])]),e("h4",{attrs:{id:"total-number-of-aks-clusters-by-subscription"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#total-number-of-aks-clusters-by-subscription"}},[t._v("#")]),t._v(" Total Number of AKS Clusters by Subscription")]),t._v(" "),e("div",{staticClass:"language-py extra-class"},[e("pre",{pre:!0,attrs:{class:"language-py"}},[e("code",[t._v("ResourceContainers  \n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" where "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"microsoft.resources/subscriptions"')]),t._v("  \n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" project SubscriptionName "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" subscriptionId \n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" join "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" \t\t\n        resources \n        "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" where "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),t._v(" contains "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"microsoft.containerservice/managedclusters"')]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" summarize number_of_resosurces "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" count"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" by subscriptionId\t\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" on subscriptionId  \n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" project"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("away subscriptionId"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("subscriptionId1 \n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" project SubscriptionName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" count "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" number_of_resosurces\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" order by "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"count"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" desc\n")])])]),e("h4",{attrs:{id:"total-number-of-aks-clustes-grouped-by-tags"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#total-number-of-aks-clustes-grouped-by-tags"}},[t._v("#")]),t._v(" Total number of AKS Clustes grouped by tags")]),t._v(" "),e("p",[t._v("Following query assumes you have either "),e("code",[t._v("stage")]),t._v(" or "),e("code",[t._v("Stage")]),t._v(" tag in your AKS Clster and trying to summarize the count by that tag value.")]),t._v(" "),e("div",{staticClass:"language-py extra-class"},[e("pre",{pre:!0,attrs:{class:"language-py"}},[e("code",[t._v("resources\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" where "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),t._v(" contains "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"microsoft.containerservice/managedclusters"')]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" extend stage "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" strcat"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tags"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stage"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tags"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Stage"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" extend stage "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" iff"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isempty"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("stage"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Unknown'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" stage"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" summarize count "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" count"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" by stage\n")])])]),e("h4",{attrs:{id:"cluster-size-information-by-agent-pool"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cluster-size-information-by-agent-pool"}},[t._v("#")]),t._v(" Cluster Size information by Agent Pool")]),t._v(" "),e("div",{staticClass:"language-py extra-class"},[e("pre",{pre:!0,attrs:{class:"language-py"}},[e("code",[t._v("resources\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" where "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),t._v(" contains "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"microsoft.containerservice/managedclusters"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" mv"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("expand agentPoolProfile "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" properties"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("agentPoolProfiles\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" extend agentPoolId "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" strcat"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('" / "')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" agentPoolProfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" project \n    agent_pool_name "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" agentPoolId "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    nodes_count "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" agentPoolProfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"count"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    minCount "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" agentPoolProfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"minCount"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    maxCount "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" agentPoolProfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"maxCount"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    enableAutoScaling "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" agentPoolProfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"enableAutoScaling"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    maxPods "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" agentPoolProfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"maxPods"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    vmSize "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" agentPoolProfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vmSize"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n\tpoolType "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" agentPoolProfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"type"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    osDiskSizeGB "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" agentPoolProfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"osDiskSizeGB"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),e("h4",{attrs:{id:"total-nodes-count"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#total-nodes-count"}},[t._v("#")]),t._v(" Total Nodes count")]),t._v(" "),e("div",{staticClass:"language-py extra-class"},[e("pre",{pre:!0,attrs:{class:"language-py"}},[e("code",[t._v("resources\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" where "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),t._v(" contains "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"microsoft.containerservice/managedclusters"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" mv"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("expand agentPoolProfile "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" properties"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("agentPoolProfiles\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" summarize total_nodes "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("sum")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("toint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("agentPoolProfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"count"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h4",{attrs:{id:"total-number-of-agent-pools-and-nodes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#total-number-of-agent-pools-and-nodes"}},[t._v("#")]),t._v(" Total number of agent pools and nodes")]),t._v(" "),e("div",{staticClass:"language-py extra-class"},[e("pre",{pre:!0,attrs:{class:"language-py"}},[e("code",[t._v("resources\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" where "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),t._v(" contains "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"microsoft.containerservice/managedclusters"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" mv"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("expand agentPoolProfile "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" properties"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("agentPoolProfiles\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" summarize total_agent_pools "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" count"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n            total_nodes "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("sum")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("toint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("agentPoolProfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"count"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n        by cluster_name "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" name\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" order by total_nodes desc\n")])])]),e("h4",{attrs:{id:"clusters-and-their-corresponding-log-analytics-workspace"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#clusters-and-their-corresponding-log-analytics-workspace"}},[t._v("#")]),t._v(" Clusters and their corresponding Log Analytics workspace")]),t._v(" "),e("div",{staticClass:"language-py extra-class"},[e("pre",{pre:!0,attrs:{class:"language-py"}},[e("code",[t._v("resources\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" where "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),t._v(" contains "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"microsoft.containerservice/managedclusters"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" extend la_id "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" properties"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("addonProfiles"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("omsagent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("logAnalyticsWorkspaceResourceID\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" project name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Log_Anlytics_ID "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" split"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("la_id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),e("Signature")],1)}),[],!1,null,null,null);s.default=r.exports}}]);